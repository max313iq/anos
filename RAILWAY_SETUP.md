# Railway Deployment Setup

## Step 1: Add Redis to Railway

1. Go to your Railway project dashboard
2. Click **"+ New"** â†’ **"Database"** â†’ **"Add Redis"**
3. Railway will automatically create these environment variables:
   - `REDIS_HOST` (use: `redis.railway.internal`)
   - `REDIS_PORT` (default: `6379`)
   - `REDIS_PASSWORD`

## Step 2: Update Environment Variables

In your Railway service, set these variables:

```bash
# Database (use internal URL for faster connections)
DATABASE_URL=postgresql://postgres:ewJimjnmajcUjpxXDnjEUuOJoWEqiliE@postgres.railway.internal:5432/railway

# Redis (Railway will auto-populate these when you add Redis)
REDIS_HOST=redis.railway.internal
REDIS_PORT=6379
REDIS_PASSWORD=<auto-generated-by-railway>

# LiteLLM Settings
LITELLM_MODE=PRODUCTION
```

## Step 3: Set Up UptimeRobot (Keep Service Awake)

### Option A: UptimeRobot (Free, Recommended)

1. Go to [https://uptimerobot.com](https://uptimerobot.com)
2. Sign up for free account
3. Click **"Add New Monitor"**
4. Configure:
   - **Monitor Type:** HTTP(s)
   - **Friendly Name:** LiteLLM Proxy
   - **URL:** `https://your-app.railway.app/health`
   - **Monitoring Interval:** 5 minutes
   - **Monitor Timeout:** 30 seconds
5. Click **"Create Monitor"**

âœ… Your service will now stay awake 24/7!

### Option B: Cron-Job.org (Alternative)

1. Go to [https://cron-job.org](https://cron-job.org)
2. Sign up for free
3. Create new cron job:
   - **URL:** `https://your-app.railway.app/health`
   - **Schedule:** Every 5 minutes
   - **Timeout:** 30 seconds

### Option C: GitHub Actions (Free, Advanced)

Create `.github/workflows/keep-alive.yml`:

```yaml
name: Keep Railway Service Alive

on:
  schedule:
    - cron: '*/5 * * * *'  # Every 5 minutes
  workflow_dispatch:  # Manual trigger

jobs:
  ping:
    runs-on: ubuntu-latest
    steps:
      - name: Ping Railway Service
        run: |
          curl -f https://your-app.railway.app/health || exit 0
```

## Step 4: Verify Setup

### Check Redis Connection
```bash
# SSH into Railway or check logs
curl https://your-app.railway.app/health

# Should see cache stats in response
```

### Check Database Connection
```bash
# Verify using internal URL
curl https://your-app.railway.app/health/db
```

### Monitor Performance
```bash
# Test response time
curl -w "Time: %{time_total}s\n" -o /dev/null -s https://your-app.railway.app/health
```

## Expected Performance Improvements

| Metric | Before | After |
|--------|--------|-------|
| Cold Start | 10-30s | 0s (always warm) |
| Response Time | 500-1000ms | 100-300ms |
| Database Queries | Every request | Cached (10min TTL) |
| Uptime | 95% | 99.9% |

## Troubleshooting

### Redis Not Connecting
```bash
# Check Railway logs for:
Error: Could not connect to Redis

# Solution: Verify REDIS_HOST is set to redis.railway.internal
```

### Database Connection Issues
```bash
# If you see connection errors, use public URL temporarily:
DATABASE_URL=postgresql://postgres:ewJimjnmajcUjpxXDnjEUuOJoWEqiliE@hopper.proxy.rlwy.net:16649/railway
```

### UptimeRobot Not Working
```bash
# Verify your health endpoint works:
curl https://your-app.railway.app/health

# Should return: {"status": "healthy"}
```

## Cost Breakdown

| Service | Cost |
|---------|------|
| Railway Hobby Plan | $5/mo |
| PostgreSQL Database | Included |
| Redis Database | Included |
| UptimeRobot | Free |
| **Total** | **$5/mo** |

## Next Steps

1. âœ… Add Redis to Railway
2. âœ… Update environment variables
3. âœ… Set up UptimeRobot
4. âœ… Deploy updated config
5. âœ… Monitor performance

Your Railway deployment will now be as fast as Gitpod! ðŸš€
